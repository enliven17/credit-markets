/* eslint-disable @typescript-eslint/no-explicit-any */`n"use client";`n`nimport { Badge } from "@/components/ui/badge";`nimport { Button } from "@/components/ui/button";`nimport { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";`nimport { Input } from "@/components/ui/input";`nimport { Label } from "@/components/ui/label";`nimport {`n  Select,`n  SelectContent,`n  SelectItem,`n  SelectTrigger,`n  SelectValue`n} from "@/components/ui/select";`nimport { Textarea } from "@/components/ui/textarea";`nimport flowConfig from '@/lib/flow/config';`nimport * as fcl from "@onflow/fcl";`nimport {`n  AlertTriangle,`n  ArrowLeft,`n  Calendar,`n  CheckCircle,`n  Clock,`n  ExternalLink,`n  Search,`n  TrendingUp,`n  Users,`n  Wallet,`n  XCircle`n} from "lucide-react";`nimport Link from "next/link";`nimport { useRouter, useSearchParams } from "next/navigation";`nimport { ChangeEvent, JSX, Suspense, useEffect, useState } from "react";`nimport { toast } from "sonner";`n`n// Import your Credit Predict scripts`nimport {`n  getAllMarkets,`n  resolveMarketTransaction`n} from '@/lib/flow-wager-scripts';`n`n// Import your existing types`nimport type {`n  Market`n} from "@/types/market";`n`nimport {`n  MarketCategoryLabels,`n  MarketOutcome`n} from "@/types/market";`n`n// Your existing auth hook`nimport { useAuth } from "@/providers/auth-provider";`n`n// Resolution form data interface`ninterface ResolutionData {`n  outcome: string;`n  evidence: string;`n  sourceUrl: string;`n  adminNotes: string;`n}`n`nfunction AdminResolveContent(): JSX.Element {`n  const searchParams = useSearchParams();`n  const router = useRouter();`n  const marketIdParam = searchParams.get("id");`n  `n  // Use your existing auth hook`n  const { `n    user,`n    isAuthenticated: loggedIn, `n    isLoading: authLoading`n  } = useAuth();`n  `n  // State management`n  const [markets, setMarkets] = useState<Market[]>([]);`n  const [marketsLoading, setMarketsLoading] = useState(true);`n  const [marketsError, setMarketsError] = useState<string | null>(null);`n  const [resolving, setResolving] = useState<boolean>(false);`n  const [resolutionError, setResolutionError] = useState<string | null>(null);`n  `n  // Component state`n  const [selectedMarket, setSelectedMarket] = useState<Market | null>(null);`n  const [resolutionData, setResolutionData] = useState<ResolutionData>({`n    outcome: "",`n    evidence: "",`n    sourceUrl: "",`n    adminNotes: ""`n  });`n  const [searchQuery, setSearchQuery] = useState<string>("");`n`n`n  // Simple admin check`n  const isAdmin = loggedIn && user?.addr;`n`n  // Initialize Flow configuration`n  useEffect(() => {`n    const initFlow = async () => {`n      try {`n        flowConfig();`n        console.log('Flow configuration initialized for admin resolve');`n      } catch (error) {`n        console.error('Failed to initialize Flow configuration:', error);`n      }`n    };`n`n    initFlow();`n  }, []);`n`n  // Fetch pending markets using your Flow scripts`n  useEffect(() => {`n    const fetchMarkets = async () => {`n      if (!loggedIn) return;`n      try {`n        setMarketsLoading(true);`n        setMarketsError(null);`n        // Get all markets using your script`n        const allMarketsScript = await getAllMarkets();`n        const allMarkets = await fcl.query({ cadence: allMarketsScript });`n        // Filter for markets that have ended and are not resolved`n        const now = Date.now() / 1000;`n        const pendingMarkets = (allMarkets || []).filter((market: any) => {`n          return parseFloat(market.endTime) < now && !market.resolved;`n        });`n        setMarkets(pendingMarkets);`n      } catch (error) {`n        console.error("Failed to fetch markets:", error);`n        setMarketsError("Failed to load markets from contract");`n      } finally {`n        setMarketsLoading(false);`n      }`n    };`n    fetchMarkets();`n  }, [loggedIn]);`n`n  // Load specific market if ID provided`n  useEffect(() => {`n    if (marketIdParam && markets.length > 0) {`n      const market = markets.find((m: Market) => m.id === marketIdParam);`n      if (market) {`n        setSelectedMarket(market);`n      }`n    }`n  }, [marketIdParam, markets]);`n`n  // Redirect non-admin users`n  useEffect(() => {`n    if (!authLoading && loggedIn && !isAdmin) {`n      toast.error("You don't have admin privileges");`n      router.push("/");`n    }`n  }, [loggedIn, isAdmin, authLoading, router]);`n`n  // Filter markets with proper typing`n  const filteredMarkets: Market[] = markets.filter((market: Market) =>`n    market.title.toLowerCase().includes(searchQuery.toLowerCase()) ||`n    (market.category in MarketCategoryLabels && MarketCategoryLabels[market.category as keyof typeof MarketCategoryLabels]?.toLowerCase().includes(searchQuery.toLowerCase()))`n  );`n`n  // Event handlers with proper typing`n  const handleMarketSelect = (market: Market): void => {`n    setSelectedMarket(market);`n    setResolutionData({`n      outcome: "",`n      evidence: "",`n      sourceUrl: "",`n      adminNotes: ""`n    });`n  };`n`n  const handleInputChange = (`n    field: keyof ResolutionData`n  ) => (e: ChangeEvent<HTMLInputElement | HTMLTextAreaElement>): void => {`n    setResolutionData(prev => ({ ...prev, [field]: e.target.value }));`n  };`n`n  const handleOutcomeChange = (value: string): void => {`n    setResolutionData(prev => ({ ...prev, outcome: value }));`n  };`n`n  const handleSearchChange = (e: ChangeEvent<HTMLInputElement>): void => {`n    setSearchQuery(e.target.value);`n  };`n`n  // ğŸš¨ UPDATED: Use your Credit Predict resolve script`n  const handleResolve = async (): Promise<void> => {`n    if (!selectedMarket || !resolutionData.outcome) {`n      toast.error("Please select an outcome");`n      return;`n    }`n`n    if (!resolutionData.evidence.trim()) {`n      toast.error("Please provide evidence for the resolution");`n      return;`n    }`n`n    if (!isAdmin) {`n      toast.error("You don't have admin privileges");`n      return;`n    }`n`n    setResolving(true);`n    setResolutionError(null);`n`n    try {`n      // Validate inputs`n      const marketId = parseInt(selectedMarket.id);`n      const outcomeValue = parseInt(resolutionData.outcome);`n      const justification = resolutionData.evidence.trim();`n      `n      if (isNaN(marketId) || isNaN(outcomeValue)) {`n        throw new Error("Invalid market ID or outcome");`n      }`n`n      console.log("Resolving market with your Credit Predict script:", { `n        marketId, `n        outcomeValue, `n        evidence: resolutionData.evidence.trim() `n      });`n`n      toast.loading("Submitting resolution transaction...");`n`n      // ğŸš¨ USE YOUR Credit Predict RESOLVE SCRIPT ğŸš¨`n      const transactionScript = await resolveMarketTransaction();`n      `n      console.log("Using resolution script from flow-wager-scripts");`n`n      const authorization = fcl.currentUser().authorization;`n      const transactionId = await fcl.mutate({`n        cadence: transactionScript,`n        args: (arg, t) => [`n          arg(marketId, t.UInt64),      // marketId`n          arg(outcomeValue, t.UInt8),   // outcome (MarketOutcome enum value)`n          arg(justification, t.String), // justification`n        ],`n        proposer: authorization,`n        payer: authorization,`n        authorizations: [authorization],`n        limit: 1000`n      });`n`n      console.log("Resolution transaction submitted:", transactionId);`n      toast.dismiss();`n      toast.loading("Waiting for transaction to be sealed...");`n`n      // Wait for transaction to be sealed`n      const result = await fcl.tx(transactionId).onceSealed();`n      console.log("Transaction sealed:", result);`n      toast.dismiss();`n`n      if (result.status === 4) { // SEALED`n        toast.success("Market resolved successfully!", {`n          description: `Transaction ID: ${transactionId}`,`n          duration: 5000`n        });`n        `n        // Refresh markets by re-fetching`n        const allMarketsScript = await getAllMarkets();`n        const updatedMarkets = await fcl.query({`n          cadence: allMarketsScript,`n        });`n`n        // Filter for pending markets again`n        const now = Date.now() / 1000;`n        const pendingMarkets = updatedMarkets?.filter((market: any) => {`n          const endTime = parseFloat(market.endTime);`n          const isEnded = endTime < now;`n          const isPending = market.status === 'Active';`n          `n          return isEnded && isPending;`n        }) || [];`n`n        setMarkets(pendingMarkets);`n        `n        // Reset form`n        setSelectedMarket(null);`n        setResolutionData({`n          outcome: "",`n          evidence: "",`n          sourceUrl: "",`n          adminNotes: ""`n        });`n        `n        router.push("/admin");`n      } else {`n        throw new Error(`Transaction failed with status: ${result.status}`);`n      }`n`n    } catch (error: unknown) {`n      console.error("Resolution failed:", error);`n      `n      let errorMessage = "Unknown error occurred";`n      `n      if (error instanceof Error) {`n        errorMessage = error.message;`n      }`n      `n      // Handle specific Flow errors`n      if (errorMessage.includes('Could not borrow Admin reference')) {`n        errorMessage = "Only admin accounts can resolve markets. Please ensure you're using an authorized admin wallet.";`n      } else if (errorMessage.includes('panic:')) {`n        const panicMatch = errorMessage.match(/panic: (.+?)(?:\n|$)/);`n        if (panicMatch) {`n          errorMessage = panicMatch[1];`n        }`n      }`n      `n      setResolutionError(errorMessage);`n      toast.dismiss();`n      toast.error("Failed to resolve market", {`n        description: errorMessage,`n        duration: 6000`n      });`n    } finally {`n      setResolving(false);`n    }`n  };`n`n  // Utility functions with proper typing`n  const formatCurrency = (value: string | number): string => {`n    const numValue = typeof value === 'string' ? parseFloat(value) : value;`n    if (isNaN(numValue)) return "0";`n    if (numValue >= 1000000) return `${(numValue / 1000000).toFixed(1)}M`;`n    if (numValue >= 1000) return `${(numValue / 1000).toFixed(1)}K`;`n    return numValue.toFixed(2);`n  };`n`n  const getTimeSinceEnd = (endTime: string): string => {`n    const endTimestamp = parseFloat(endTime) * 1000;`n    if (isNaN(endTimestamp)) return "Unknown";`n    `n    const diff = Date.now() - endTimestamp;`n    const hours = Math.floor(diff / (1000 * 60 * 60));`n    const days = Math.floor(hours / 24);`n    `n    if (days > 0) return `${days} day${days > 1 ? 's' : ''} ago`;`n    if (hours > 0) return `${hours} hour${hours > 1 ? 's' : ''} ago`;`n    return "Just ended";`n  };`n`n  const formatDate = (timestamp: string): string => {`n    const timestampMs = parseFloat(timestamp) * 1000;`n    if (isNaN(timestampMs)) return "Invalid date";`n    `n    return new Date(timestampMs).toLocaleDateString('en-US', {`n      year: 'numeric',`n      month: 'short',`n      day: 'numeric',`n      hour: '2-digit',`n      minute: '2-digit'`n    });`n  };`n`n  const getTotalShares = (market: Market): number => {`n    return parseFloat(market.totalOptionAShares) + parseFloat(market.totalOptionBShares);`n  };`n`n  const getWinningAmount = (market: Market, outcome: MarketOutcome): number => {`n    const totalPool = parseFloat(market.totalPool);`n    const totalShares = getTotalShares(market);`n    `n    if (outcome === MarketOutcome.Cancelled) return totalPool;`n    if (outcome === MarketOutcome.OptionA) {`n      const optionAShares = parseFloat(market.totalOptionAShares);`n      return totalShares > 0 ? totalPool * (optionAShares / totalShares) : 0;`n    }`n    if (outcome === MarketOutcome.OptionB) {`n      const optionBShares = parseFloat(market.totalOptionBShares);`n      return totalShares > 0 ? totalPool * (optionBShares / totalShares) : 0;`n    }`n    return 0;`n  };`n`n  const getEstimatedParticipants = (market: Market): number => {`n    return Math.max(1, Math.floor(getTotalShares(market) / 100));`n  };`n`n  const getSharePercentage = (shares: string, totalShares: number): number => {`n    if (totalShares === 0) return 0;`n    return (parseFloat(shares) / totalShares) * 100;`n  };`n`n  const getOutcomeLabel = (outcome: MarketOutcome): string => {`n    switch (outcome) {`n      case MarketOutcome.OptionA:`n        return selectedMarket?.optionA || "Option A";`n      case MarketOutcome.OptionB:`n        return selectedMarket?.optionB || "Option B";`n      case MarketOutcome.Draw:`n        return "Draw";`n      case MarketOutcome.Cancelled:`n        return "Cancel Market";`n      default:`n        return "Unknown";`n    }`n  };`n`n  // Show loading while checking authentication`n  if (authLoading) {`n    return (`n      <div className="min-h-screen flex flex-col bg-[#0A0C14] text-white">`n        <div className="container mx-auto px-4 py-8">`n          <div className="text-center">`n            <div className="animate-spin rounded-full h-16 w-16 border-4 border-blue-500 border-b-transparent mx-auto mb-4"></div>`n            <p className="text-gray-400">Checking authentication...</p>`n          </div>`n        </div>`n      </div>`n    );`n  }`n`n  // Show authentication prompt if not logged in`n  if (!loggedIn) {`n    return (`n      <div className="min-h-screen flex flex-col bg-[#0A0C14] text-white">`n        <div className="container mx-auto px-4 py-8">`n          <Card className="max-w-md mx-auto bg-gray-900 border-gray-700">`n            <CardHeader>`n              <CardTitle className="flex items-center gap-2 text-white">`n                <Wallet className="h-5 w-5" />`n                Authentication Required`n              </CardTitle>`n            </CardHeader>`n            <CardContent className="space-y-4">`n              <p className="text-gray-400">`n                You need to connect your wallet to access the admin panel.`n              </p>`n              <Button onClick={() => router.push("/markets")} className="w-full bg-blue-600 hover:bg-blue-700">`n                Go to Markets`n              </Button>`n            </CardContent>`n          </Card>`n        </div>`n      </div>`n    );`n  }`n`n  // Show unauthorized message if not admin`n  if (!isAdmin) {`n    return (`n      <div className="min-h-screen flex flex-col bg-[#0A0C14] text-white">`n        <div className="container mx-auto px-4 py-8">`n          <Card className="max-w-md mx-auto bg-gray-900 border-gray-700">`n            <CardHeader>`n              <CardTitle className="flex items-center gap-2 text-red-400">`n                <XCircle className="h-5 w-5" />`n                Access Denied`n              </CardTitle>`n            </CardHeader>`n            <CardContent>`n              <p className="text-gray-400 mb-4">`n                You don&lsquo;t have admin privileges to access this page.`n              </p>`n              <div className="text-xs text-gray-500 mb-4">`n                Connected as: {user?.addr}`n              </div>`n              <Button asChild className="w-full bg-blue-600 hover:bg-blue-700">`n                <Link href="/">Go to Home</Link>`n              </Button>`n            </CardContent>`n          </Card>`n        </div>`n      </div>`n    );`n  }`n`n  return (`n    <div className="min-h-screen flex flex-col bg-[#0A0C14] text-white">`n      {/* Responsive container */}`n      <div className="container mx-auto px-2 py-4 space-y-6">`n        {/* Header: stack vertically on mobile, row on desktop */}`n        <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4 w-full">`n          <div className="flex items-center space-x-4">`n            <Button variant="outline" size="sm" asChild className="border-gray-600 hover:bg-gray-800 text-white">`n              <Link href="/admin">`n                <ArrowLeft className="h-4 w-4 mr-2" />`n                Back to Admin`n              </Link>`n            </Button>`n            <div>`n              <h1 className="text-3xl md:text-4xl font-bold">Resolve Markets</h1>`n              <p className="text-gray-400">`n                Determine outcomes for markets that have ended`n              </p>`n              <div className="text-xs text-gray-500 mt-1">`n                Admin: {user?.addr?.slice(0, 6)}...{user?.addr?.slice(-4)}`n                <Badge className="ml-2 bg-green-500/20 text-green-400 border-green-500/30">`n                  Credit Predict Admin`n                </Badge>`n              </div>`n            </div>`n          </div>`n          `n          <div className="flex items-center gap-3">`n            <Badge variant="destructive" className="flex items-center gap-1">`n              <AlertTriangle className="h-3 w-3" />`n              {markets.length} Pending Resolution`n            </Badge>`n          </div>`n        </div>`n`n        {/* Show errors */}`n        {marketsError && (`n          <Card className="border-red-500 bg-red-900/20 backdrop-blur">`n            <CardContent className="p-4">`n              <div className="flex items-center gap-2 text-red-400">`n                <AlertTriangle className="h-4 w-4" />`n                <span>Error loading markets: {marketsError}</span>`n              </div>`n            </CardContent>`n          </Card>`n        )}`n`n        {resolutionError && (`n          <Card className="border-red-500 bg-red-900/20 backdrop-blur">`n            <CardContent className="p-4">`n              <div className="flex items-center gap-2 text-red-400">`n                <AlertTriangle className="h-4 w-4" />`n                <span>Resolution error: {resolutionError}</span>`n              </div>`n            </CardContent>`n          </Card>`n        )}`n`n        {/* Responsive grid for main content */}`n        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 w-full">`n          {/* Market Selection */}`n          <div className="space-y-6 w-full">`n            <Card className="bg-gray-900/50 border-gray-700 backdrop-blur w-full">`n              <CardHeader>`n                <CardTitle className="flex items-center gap-2 text-white text-base md:text-lg">`n                  <Clock className="h-5 w-5" />`n                  Markets Pending Resolution`n                  {marketsLoading && (`n                    <div className="animate-spin rounded-full h-4 w-4 border-2 border-blue-500 border-b-transparent" />`n                  )}`n                </CardTitle>`n              </CardHeader>`n              <CardContent className="space-y-4 w-full">`n                {/* Search */}`n                <div className="relative w-full">`n                  <Search className="absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400" />`n                  <Input`n                    placeholder="Search markets by question or category..."`n                    value={searchQuery}`n                    onChange={handleSearchChange}`n                    className="pl-9 bg-gray-800 border-gray-600 text-white placeholder:text-gray-400 focus:border-blue-500 h-12 text-base w-full"`n                  />`n                </div>`n`n                {/* Market List: scrollable on mobile */}`n                <div className="space-y-3 max-h-[500px] overflow-y-auto w-full">`n                  {marketsLoading ? (`n                    <div className="text-center py-8 text-gray-400">`n                      <div className="animate-spin rounded-full h-8 w-8 border-2 border-blue-500 border-b-transparent mx-auto mb-2" />`n                      <p>Loading markets from Flow blockchain...</p>`n                    </div>`n                  ) : filteredMarkets.length === 0 ? (`n                    <div className="text-center py-8 text-gray-400">`n                      <Search className="h-8 w-8 mx-auto mb-2 opacity-50" />`n                      <p>No markets found matching your search.</p>`n                      {markets.length === 0 && (`n                        <p className="text-sm mt-2">All markets may already be resolved.</p>`n                      )}`n                    </div>`n                  ) : (`n                    filteredMarkets.map((market: Market) => {`n                      const totalShares = getTotalShares(market);`n                      return (`n                        <div`n                          key={market.id}`n                          className={`p-4 border rounded-lg cursor-pointer transition-all hover:shadow-lg ${`n                            selectedMarket?.id === market.id`n                              ? "border-blue-500 bg-blue-900/20 shadow-lg shadow-blue-500/20"`n                              : "border-gray-600 bg-gray-800/50 hover:bg-gray-700/50 hover:border-gray-500"`n                          }`}`n                          onClick={() => handleMarketSelect(market)}`n                        >`n                          <div className="flex items-start justify-between mb-3">`n                            <div className="flex items-center space-x-2">`n                              <Badge variant="outline" className="text-orange-400 border-orange-500 bg-orange-900/20">`n                                Pending`n                              </Badge>`n                              <Badge variant="secondary" className="bg-gray-700 text-gray-200">`n                                {MarketCategoryLabels[market.category as keyof typeof MarketCategoryLabels] || "Unknown"}`n                              </Badge>`n                            </div>`n                            <span className="text-xs text-gray-400 bg-gray-700 px-2 py-1 rounded">`n                              #{market.id}`n                            </span>`n                          </div>`n                          `n                          {/* Add line-clamp and break-words for long titles */}`n                          <h4 className="font-medium mb-3 line-clamp-2 text-sm md:text-base text-white break-words">`n                            {market.title}`n                          </h4>`n                          `n                          <div className="grid grid-cols-2 gap-4 text-xs mb-3">`n                            <div className="flex items-center gap-1">`n                              <TrendingUp className="h-3 w-3 text-gray-400" />`n                              <span className="text-gray-400">Volume:</span>`n                              <span className="font-medium text-white">{formatCurrency(market.totalPool)} FLOW</span>`n                            </div>`n                            <div className="flex items-center gap-1">`n                              <Clock className="h-3 w-3 text-gray-400" />`n                              <span className="text-gray-400">Ended:</span>`n                              <span className="font-medium text-white">{getTimeSinceEnd(market.endTime)}</span>`n                            </div>`n                            <div className="flex items-center gap-1">`n                              <Users className="h-3 w-3 text-gray-400" />`n                              <span className="text-gray-400">Traders:</span>`n                              <span className="font-medium text-white">{getEstimatedParticipants(market)}</span>`n                            </div>`n                            <div className="flex items-center gap-1">`n                              <Calendar className="h-3 w-3 text-gray-400" />`n                              <span className="text-gray-400">Shares:</span>`n                              <span className="font-medium text-white">{totalShares.toLocaleString()}</span>`n                            </div>`n                          </div>`n                          `n                          <div className="space-y-2">`n                            <div className="flex justify-between text-xs">`n                              <span className="text-green-400">`n                                {market.optionA}: {getSharePercentage(market.totalOptionAShares, totalShares).toFixed(1)}%`n                              </span>`n                              <span className="text-blue-400">`n                                {market.optionB}: {getSharePercentage(market.totalOptionBShares, totalShares).toFixed(1)}%`n                              </span>`n                            </div>`n                            <div className="w-full bg-gray-700 rounded-full h-2">`n                              <div `n                                className="bg-gradient-to-r from-green-500 to-green-400 h-2 rounded-full transition-all" `n                                style={{ `n                                  width: `${getSharePercentage(market.totalOptionAShares, totalShares)}%``n                                }}`n                              />`n                            </div>`n                          </div>`n                        </div>`n                      );`n                    })`n                  )}`n                </div>`n              </CardContent>`n            </Card>`n          </div>`n`n          {/* Resolution Form */}`n          <div className="space-y-6 w-full">`n            {selectedMarket ? (`n              <>`n                {/* Market Details */}`n                <Card className="bg-gray-900/50 border-gray-700 backdrop-blur w-full">`n                  <CardHeader>`n                    <CardTitle className="flex items-center justify-between text-white">`n                      <span>Market Details</span>`n                      <Button variant="outline" size="sm" asChild className="border-gray-600 hover:bg-gray-800 text-white">`n                        <Link href={`/markets/${selectedMarket.id}`} target="_blank">`n                          <ExternalLink className="h-4 w-4 mr-2" />`n                          View Market`n                        </Link>`n                      </Button>`n                    </CardTitle>`n                  </CardHeader>`n                  <CardContent className="space-y-6">`n                    <div>`n                      <h4 className="font-medium mb-3 text-white">{selectedMarket.title}</h4>`n                      <div className="grid grid-cols-2 gap-4 text-sm">`n                        <div>`n                          <span className="text-gray-400">Category:</span>`n                          <div className="font-medium text-white">{MarketCategoryLabels[selectedMarket.category as keyof typeof MarketCategoryLabels] || "Unknown"}</div>`n                        </div>`n                        <div>`n                          <span className="text-gray-400">Creator:</span>`n                          <div className="font-mono text-xs bg-gray-800 text-gray-200 px-2 py-1 rounded">`n                            {selectedMarket.creator.slice(0, 6)}...{selectedMarket.creator.slice(-4)}`n                          </div>`n                        </div>`n                        <div>`n                          <span className="text-gray-400">Total Pool:</span>`n                          <div className="font-medium text-green-400">{formatCurrency(selectedMarket.totalPool)} FLOW</div>`n                        </div>`n                        <div>`n                          <span className="text-gray-400">Est. Participants:</span>`n                          <div className="font-medium text-white">{getEstimatedParticipants(selectedMarket).toLocaleString()}</div>`n                        </div>`n                        <div>`n                          <span className="text-gray-400">Total Shares:</span>`n                          <div className="text-xs text-white">{getTotalShares(selectedMarket).toLocaleString()}</div>`n                        </div>`n                        <div>`n                          <span className="text-gray-400">Ended:</span>`n                          <div className="text-xs text-white">{formatDate(selectedMarket.endTime)}</div>`n                        </div>`n                      </div>`n                    </div>`n`n                    <div className="space-y-3">`n                      <h5 className="font-medium text-white">Current Distribution</h5>`n                      <div className="space-y-4">`n                        <div className="flex items-center justify-between p-3 bg-green-900/30 border border-green-700/50 rounded-lg">`n                          <div>`n                            <span className="text-sm font-medium text-green-300">{selectedMarket.optionA}</span>`n                            <div className="text-xs text-green-400">Option A</div>`n                          </div>`n                          <div className="text-right">`n                            <div className="font-medium text-white">{parseFloat(selectedMarket.totalOptionAShares).toLocaleString()} shares</div>`n                            <div className="text-sm text-green-400">`n                              {getSharePercentage(selectedMarket.totalOptionAShares, getTotalShares(selectedMarket)).toFixed(1)}%`n                            </div>`n                          </div>`n                        </div>`n                        `n                        <div className="flex items-center justify-between p-3 bg-blue-900/30 border border-blue-700/50 rounded-lg">`n                          <div>`n                            <span className="text-sm font-medium text-blue-300">{selectedMarket.optionB}</span>`n                            <div className="text-xs text-blue-400">Option B</div>`n                          </div>`n                          <div className="text-right">`n                            <div className="font-medium text-white">{parseFloat(selectedMarket.totalOptionBShares).toLocaleString()} shares</div>`n                            <div className="text-sm text-blue-400">`n                              {getSharePercentage(selectedMarket.totalOptionBShares, getTotalShares(selectedMarket)).toFixed(1)}%`n                            </div>`n                          </div>`n                        </div>`n                      </div>`n                    </div>`n                  </CardContent>`n                </Card>`n`n                {/* Resolution Form */}`n                <Card className="bg-gray-900/50 border-gray-700 backdrop-blur w-full">`n                  <CardHeader>`n                    <CardTitle className="flex items-center gap-2 text-white text-base md:text-lg">`n                      <CheckCircle className="h-5 w-5" />`n                      Resolution`n                    </CardTitle>`n                  </CardHeader>`n                  <CardContent className="space-y-6 w-full">`n                    {/* Outcome Selection */}`n                    <div className="space-y-3 w-full">`n                      <Label className="text-sm font-medium text-white">Outcome *</Label>`n                      <Select value={resolutionData.outcome} onValueChange={handleOutcomeChange}>`n                        <SelectTrigger className="h-12 bg-gray-800 border-gray-600 text-white text-base w-full">`n                          <SelectValue placeholder="Select the winning outcome" />`n                        </SelectTrigger>`n                        <SelectContent className="bg-gray-800 border-gray-600">`n                          <SelectItem value={MarketOutcome.OptionA.toString()} className="text-white hover:bg-gray-700">`n                            <div className="flex items-center space-x-3 py-1">`n                              <CheckCircle className="h-4 w-4 text-green-400" />`n                              <div>`n                                <div className="font-medium">{selectedMarket.optionA}</div>`n                                <div className="text-xs text-gray-400">`n                                  Winners receive: {formatCurrency(getWinningAmount(selectedMarket, MarketOutcome.OptionA))} FLOW`n                                </div>`n                              </div>`n                            </div>`n                          </SelectItem>`n                          <SelectItem value={MarketOutcome.OptionB.toString()} className="text-white hover:bg-gray-700">`n                            <div className="flex items-center space-x-3 py-1">`n                              <CheckCircle className="h-4 w-4 text-blue-400" />`n                              <div>`n                                <div className="font-medium">{selectedMarket.optionB}</div>`n                                <div className="text-xs text-gray-400">`n                                  Winners receive: {formatCurrency(getWinningAmount(selectedMarket, MarketOutcome.OptionB))} FLOW`n                                </div>`n                              </div>`n                            </div>`n                          </SelectItem>`n                          <SelectItem value={MarketOutcome.Cancelled.toString()} className="text-white hover:bg-gray-700">`n                            <div className="flex items-center space-x-3 py-1">`n                              <XCircle className="h-4 w-4 text-red-400" />`n                              <div>`n                                <div className="font-medium">Cancel Market</div>`n                                <div className="text-xs text-gray-400">`n                                  All participants get refunds`n                                </div>`n                              </div>`n                            </div>`n                          </SelectItem>`n                        </SelectContent>`n                      </Select>`n                    </div>`n`n                    {/* Evidence */}`n                    <div className="space-y-2 w-full">`n                      <Label htmlFor="evidence" className="text-sm font-medium text-white">Evidence/Reasoning *</Label>`n                      <Textarea`n                        id="evidence"`n                        placeholder="Provide detailed evidence and reasoning for this resolution. Include facts, sources, and clear explanation of why this outcome is correct..."`n                        value={resolutionData.evidence}`n                        onChange={handleInputChange("evidence")}`n                        className="min-h-32 bg-gray-800 border-gray-600 text-white placeholder:text-gray-400 focus:border-blue-500 text-base w-full"`n                        maxLength={1000}`n                      />`n                      <div className="text-xs text-gray-400">`n                        {resolutionData.evidence.length}/1000 characters`n                      </div>`n                    </div>`n`n                    {/* Source URL */}`n                    <div className="space-y-2 w-full">`n                      <Label htmlFor="sourceUrl" className="text-sm font-medium text-white">Source URL</Label>`n                      <Input`n                        id="sourceUrl"`n                        type="url"`n                        placeholder="https://example.com/proof-or-official-announcement"`n                        value={resolutionData.sourceUrl}`n                        onChange={handleInputChange("sourceUrl")}`n                        className="bg-gray-800 border-gray-600 text-white placeholder:text-gray-400 focus:border-blue-500 text-base w-full h-12"`n                      />`n                      <div className="text-xs text-gray-400">`n                        Provide a reliable source that supports your resolution`n                      </div>`n                    </div>`n`n                    {/* Admin Notes */}`n                    <div className="space-y-2 w-full">`n                      <Label htmlFor="adminNotes" className="text-sm font-medium text-white">Admin Notes (Internal)</Label>`n                      <Textarea`n                        id="adminNotes"`n                        placeholder="Internal notes for admin records, additional context, or special considerations..."`n                        value={resolutionData.adminNotes}`n                        onChange={handleInputChange("adminNotes")}`n                        rows={3}`n                        className="bg-gray-800 border-gray-600 text-white placeholder:text-gray-400 focus:border-blue-500 text-base w-full"`n                      />`n                    </div>`n`n                    {/* Resolution Preview */}`n                    {resolutionData.outcome && (`n                      <div className="p-4 bg-gray-800 border border-gray-600 rounded-lg space-y-2">`n                        <h6 className="font-medium text-sm text-white">Resolution Preview</h6>`n                        <div className="text-sm space-y-1">`n                          <div>`n                            <span className="text-gray-400">Outcome:</span>{" "}`n                            <span className="text-white">`n                              {getOutcomeLabel(parseInt(resolutionData.outcome) as MarketOutcome)}`n                            </span>`n                          </div>`n                          <div>`n                            <span className="text-gray-400">Total Distribution:</span>{" "}`n                            <span className="text-white">{formatCurrency(selectedMarket.totalPool)} FLOW</span>`n                          </div>`n                          <div>`n                            <span className="text-gray-400">Contract:</span>{" "}`n                            <span className="text-blue-400 font-mono">{process.env.NEXT_PUBLIC_Credit Predict_TESTNET_CONTRACT}</span>`n                          </div>`n                        </div>`n                      </div>`n                    )}`n`n                    {/* Warning */}`n                    <div className="flex items-start space-x-3 p-4 rounded-lg bg-yellow-900/20 border border-yellow-600/50">`n                      <AlertTriangle className="h-5 w-5 text-yellow-400 mt-0.5 flex-shrink-0" />`n                      <div className="text-sm text-yellow-200">`n                        <p className="font-medium mb-1">Resolution is permanent and irreversible</p>`n                        <p>Once resolved, this action cannot be undone. Funds will be distributed immediately using your Credit Predict contract. Please verify all information is accurate before proceeding.</p>`n                      </div>`n                    </div>`n`n                    {/* Submit Button: large and touch-friendly */}`n                    <Button `n                      onClick={handleResolve}`n                      disabled={resolving || !resolutionData.outcome || !resolutionData.evidence.trim()}`n                      className="w-full h-14 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 disabled:text-gray-400 text-base"`n                      size="lg"`n                    >`n                      {resolving ? (`n                        <div className="flex items-center gap-2">`n                          <div className="animate-spin rounded-full h-4 w-4 border-b-2 border-white" />`n                          Resolving Market...`n                        </div>`n                      ) : (`n                        `Resolve Market: ${`n                          resolutionData.outcome ? getOutcomeLabel(parseInt(resolutionData.outcome) as MarketOutcome) : "Select Outcome"`n                        }``n                      )}`n                    </Button>`n                  </CardContent>`n                </Card>`n              </>`n            ) : (`n              <Card className="bg-gray-900/50 border-gray-700 backdrop-blur">`n                <CardContent className="p-12 text-center">`n                  <Clock className="h-16 w-16 text-gray-400 mx-auto mb-4 opacity-50" />`n                  <h3 className="text-xl font-medium mb-2 text-white">Select a Market to Resolve</h3>`n                  <p className="text-gray-400 max-w-md mx-auto">`n                    Choose a market from the list on the left to begin the resolution process. Markets are loaded from your Credit Predict contract at {process.env.NEXT_PUBLIC_Credit Predict_TESTNET_CONTRACT}.`n                  </p>`n                </CardContent>`n              </Card>`n            )}`n          </div>`n        </div>`n`n        {/* Loading Overlay */}`n        {resolving && (`n          <div className="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center">`n            <Card className="w-full max-w-md mx-4 bg-gray-900 border-gray-700">`n              <CardContent className="p-8 text-center">`n                <div className="animate-spin rounded-full h-16 w-16 border-4 border-blue-500 border-b-transparent mx-auto mb-6"></div>`n                <h3 className="text-lg font-medium mb-2 text-white">Resolving Market...</h3>`n                <p className="text-gray-400 mb-4">`n                  Processing resolution using Credit Predict contract`n                </p>`n                <div className="space-y-2 text-sm text-gray-400">`n                  <div>â€¢ Validating resolution data</div>`n                  <div>â€¢ Calculating winner distributions</div>`n                  <div>â€¢ Processing blockchain transactions</div>`n                </div>`n              </CardContent>`n            </Card>`n          </div>`n        )}`n      </div>`n    </div>`n  );`n}`n`n// Loading fallback component`nfunction AdminResolveLoading(): JSX.Element {`n  return (`n    <div className="min-h-screen flex flex-col bg-[#0A0C14] text-white">`n      <div className="container mx-auto px-4 py-8">`n        <div className="flex items-center space-x-4 mb-8">`n          <Button variant="outline" size="sm" disabled className="border-gray-600 text-gray-400">`n            <ArrowLeft className="h-4 w-4 mr-2" />`n            Back to Admin`n          </Button>`n          <div>`n            <h1 className="text-3xl md:text-4xl font-bold text-white">Resolve Markets</h1>`n            <p className="text-gray-400">Loading...</p>`n          </div>`n        </div>`n        <div className="grid lg:grid-cols-2 gap-8">`n          <Card className="bg-gray-900/50 border-gray-700">`n            <CardHeader>`n              <CardTitle className="text-white">Loading Markets...</CardTitle>`n            </CardHeader>`n            <CardContent>`n              <div className="animate-pulse space-y-4">`n                <div className="h-4 bg-gray-700 rounded w-3/4"></div>`n                <div className="h-4 bg-gray-700 rounded w-1/2"></div>`n                <div className="h-4 bg-gray-700 rounded w-5/6"></div>`n              </div>`n            </CardContent>`n          </Card>`n          <Card className="bg-gray-900/50 border-gray-700">`n            <CardContent className="p-12 text-center">`n              <Clock className="h-16 w-16 text-gray-400 mx-auto mb-4 opacity-50" />`n              <h3 className="text-xl font-medium mb-2 text-white">Loading...</h3>`n            </CardContent>`n          </Card>`n        </div>`n      </div>`n    </div>`n  );`n}`n`n// Main component with Suspense boundary`nexport default function AdminResolvePage(): JSX.Element {`n  return (`n    <Suspense fallback={<AdminResolveLoading />}>`n      <AdminResolveContent />`n    </Suspense>`n  );`n}